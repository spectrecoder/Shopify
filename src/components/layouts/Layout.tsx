import Head from "next/head"
import React from "react"
import Details from "./Details"
import Sidebar from "./Sidebar"
import ActiveList from "./ActiveList"
import AddItem from "./AddItem"
import { useState } from "react"
import { useQuery, useQueryClient } from "@tanstack/react-query"
import ItemModal from "../modals/ItemModal"

interface Props {
  children: JSX.Element
}

type menu = "ActiveList" | "AddItem" | "Details"

export default function Layout({ children }: Props) {
  const queryClient = useQueryClient()
  const { data: currentMenu } = useQuery<menu | undefined>(
    ["currentMenu"],
    () => queryClient.getQueryData<menu>(["currentMenu"]),
    {
      initialData: "ActiveList",
    }
  )

  const [rightSidebar, setRightSidebar] = useState<menu>("Details")

  return (
    <main className="h-screen w-screen bg-[#FAFAFE] flex">
      <Head>
        <title>Shoppingify</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <ItemModal />
      <Sidebar queryClient={queryClient} />

      <section className="flex-grow h-full py-14 px-32 overflow-scroll hideScrollbar">
        {children}
      </section>

      {currentMenu === "ActiveList" && <ActiveList queryClient={queryClient} />}
      {currentMenu === "AddItem" && <AddItem queryClient={queryClient} />}
      {currentMenu === "Details" && <Details queryClient={queryClient} />}
    </main>
  )
}
